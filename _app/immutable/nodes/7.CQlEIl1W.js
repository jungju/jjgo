import{b as f,f as h,d as fe}from"../chunks/DvwRGfww.js";import"../chunks/ZwUaS2xh.js";import{o as Le,a as ze}from"../chunks/ClGfkG1t.js";import{an as Me,ao as z,ap as Be,aw as H,aq as Re,a as e,s as a,E as s,ar as d,ax as je,az as Ne,ay as pe,as as p,au as v,aA as Oe,t as G,u as J}from"../chunks/BuYk74-E.js";import{s as M,e as K}from"../chunks/YEDV7OB7.js";import{i as B}from"../chunks/CsOpSJIT.js";import{e as Te,i as qe}from"../chunks/DgmZXuMA.js";import{s as Ge}from"../chunks/CFqlu25O.js";import{b as Ke}from"../chunks/E4uvHImo.js";import{i as We}from"../chunks/DowsAlf2.js";import{s as Xe,a as Fe}from"../chunks/BvfUDuFd.js";import{p as He}from"../chunks/B5xI8iah.js";import{b as Je}from"../chunks/CQovgq6_.js";import{C as Pe}from"../chunks/CMb3mhhO.js";var Qe=h('<div class="remain-big svelte-1pfa8ft"> </div>'),Ue=h('<p class="eng svelte-1pfa8ft"> </p>'),Ve=h('<p class="kor svelte-1pfa8ft"> </p>'),Ye=h('<p class="placeholder svelte-1pfa8ft">•••</p>'),Ze=h('<div role="button" tabindex="0"><div class="order-big svelte-1pfa8ft"> </div> <!> <!></div> <button class="next-btn svelte-1pfa8ft">NEXT ⏭</button>',1),et=h('<div class="result-item svelte-1pfa8ft" role="button" tabindex="0"><span class="num svelte-1pfa8ft"></span> <span class="eng txt svelte-1pfa8ft"> </span> <span class="kor txt svelte-1pfa8ft"> </span></div>'),tt=h('<div class="result-list svelte-1pfa8ft"><h2 class="svelte-1pfa8ft">재생 순서 (클릭·Enter로 다시 듣기)</h2> <!></div>'),at=h('<main class="wrapper svelte-1pfa8ft"><!> <!></main> <!> <audio playsinline="" preload="auto" class="svelte-1pfa8ft"></audio>',1);function gt(ve,ce){Me(ce,!1);const ae=()=>Fe(He,"$page",de),[de,ue]=Xe(),P=s(),Q=s(),U=s(),V=s(),se=s();let i=s([]),R=s([]),l=s(-1),Y=s(0),r=s(),x=s(!1),w=s(!1),$=!1;const W=[1e4,2e4,-1];let u=s(W[0]),b=s(0),E;const S=new Set;let k=s([]),I=s(!1);Le(async()=>{const t=await fetch(`${e(Q)}/sentences.json`);if(t.ok){const o=await t.json();a(i,o.sentences),a(R,o.korean)}typeof window<"u"&&window.addEventListener("keydown",re)}),ze(()=>{e(r)?.pause(),clearInterval(E),typeof window<"u"&&window.removeEventListener("keydown",re)});function re(t){e(I)||(["Space","ArrowRight"].includes(t.code)?(t.preventDefault(),N()):t.code==="ArrowLeft"&&e(k).length>1&&(t.preventDefault(),e(k).pop(),j(e(k)[e(k).length-1],!1)))}function me(){if(S.size===e(i).length)return-1;let t;do t=Math.floor(Math.random()*e(i).length);while(S.has(t));return t}async function j(t,o=!0){if(!(t<0||t>=e(i).length)){o&&je(Y),a(l,t),S.add(t),o&&e(k).push(t),await Ne(),e(r).pause(),pe(r,e(r).src=`${e(Q)}/audio/${String(t+1).padStart(2,"0")}.mp3`);try{await e(r).play(),a(x,!0)}catch{$=!0}}}function _e(){e(r)&&pe(r,e(r).onended=()=>{if(a(x,!1),$){$=!1,N();return}if(e(u)>=0&&S.size<e(i).length){ge();return}S.size===e(i).length&&a(I,!0)})}function ge(){a(w,!0),a(b,Math.ceil(e(u)/1e3)),E=setInterval(()=>{Oe(b,-1)<=0&&(clearInterval(E),a(w,!1),e(x)?$=!0:N())},1e3)}function N(){e(r).pause(),clearInterval(E),a(x,a(w,$=!1)),a(b,0);const t=me();if(t===-1){a(I,!0);return}j(t)}function ne(){e(l)===-1?N():j(e(l),!1)}function he(){e(r).pause(),clearInterval(E),a(x,a(w,$=!1)),a(l,-1),a(Y,0),a(b,0),S.clear(),a(k,[]),a(I,!1)}let c=s("none");function we(){a(c,e(c)==="none"?"eng":e(c)==="eng"?"kor":"none")}function be(t){a(u,t),e(w)&&(clearInterval(E),a(w,!1),a(b,0))}function ke(t){switch(t.detail.id){case"stop":he();break;case"show":we();break;case"gap":be(W[(W.indexOf(e(u))+1)%W.length]);break}}z(()=>ae(),()=>{a(P,ae().params.id)}),z(()=>e(P),()=>{a(Q,`${Je}/assets/sentence/${e(P)}`)}),z(()=>e(r),()=>{e(r)&&_e()}),z(()=>e(c),()=>{a(U,e(c)==="none"?"표시:없음":e(c)==="eng"?"표시:영어":"표시:한글")}),z(()=>e(u),()=>{a(V,e(u)<0?"무제한":`${e(u)/1e3}s`)}),z(()=>(e(U),e(V)),()=>{a(se,[{id:"stop",icon:"⏹"},{id:"show",text:e(U)},{id:"gap",text:`간격:${e(V)}`}])}),Be(),We();var oe=at(),Z=H(oe),ie=p(Z);{var ye=t=>{var o=Ze(),m=H(o),O=p(m),_=p(O,!0);v(O);var X=d(O,2);{var y=n=>{var g=Qe(),A=p(g,!0);v(g),G(()=>M(A,e(b))),f(n,g)};B(X,n=>{e(u)>=0&&e(b)>0&&n(y)})}var F=d(X,2);{var T=n=>{var g=fe(),A=H(g);{var Se=C=>{var D=Ue(),te=p(D,!0);v(D),G(()=>M(te,(e(i),e(l),J(()=>e(i)[e(l)])))),f(C,D)},Ie=C=>{var D=fe(),te=H(D);{var Ae=L=>{var q=Ve(),De=p(q,!0);v(q),G(()=>M(De,(e(R),e(l),J(()=>e(R)[e(l)])))),f(L,q)},Ce=L=>{var q=Ye();f(L,q)};B(te,L=>{e(c)==="kor"?L(Ae):L(Ce,!1)},!0)}f(C,D)};B(A,C=>{e(c)==="eng"?C(Se):C(Ie,!1)})}f(n,g)};B(F,n=>{e(l)!==-1&&n(T)})}v(m);var ee=d(m,2);G(()=>{Ge(m,1,`sentence-box ${e(x)||e(w)?"playing":""}`,"svelte-1pfa8ft"),M(_,e(l)===-1?"Ready":`#${e(Y)}`)}),K("click",m,ne),K("keydown",m,n=>{["Enter"," "].includes(n.key)&&(n.preventDefault(),ne())}),K("click",ee,N),f(t,o)};B(ie,t=>{e(I)||t(ye)})}var xe=d(ie,2);{var $e=t=>{var o=tt(),m=d(p(o),2);Te(m,1,()=>e(k),qe,(O,_,X)=>{var y=et(),F=p(y);F.textContent=`${X+1}.`;var T=d(F,2),ee=p(T,!0);v(T);var n=d(T,2),g=p(n,!0);v(n),v(y),G(()=>{M(ee,(e(i),e(_),J(()=>e(i)[e(_)]))),M(g,(e(R),e(_),J(()=>e(R)[e(_)])))}),K("click",y,()=>j(e(_),!1)),K("keydown",y,A=>{["Enter"," "].includes(A.key)&&(A.preventDefault(),j(e(_),!1))}),f(O,y)}),v(o),f(t,o)};B(xe,t=>{e(I)&&t($e)})}v(Z);var le=d(Z,2);Pe(le,{get buttons(){return e(se)},$$events:{click:ke,toggle:t=>a(c,t.detail.visible)}});var Ee=d(le,2);Ke(Ee,t=>a(r,t),()=>e(r)),f(ve,oe),Re(),ue()}export{gt as component};
