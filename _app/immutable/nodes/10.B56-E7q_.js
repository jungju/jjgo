import{b as E,f as S,d as De}from"../chunks/DvwRGfww.js";import"../chunks/ZwUaS2xh.js";import{o as Fe,a as Ie}from"../chunks/ClGfkG1t.js";import{an as Me,ao as i,ap as Pe,aw as oe,t as X,aq as Re,a as e,s as t,E as s,ar as C,az as ze,ay as ne,as as g,u as re,au as k,ax as Ge,aA as Ne}from"../chunks/BuYk74-E.js";import{s as H,e as le}from"../chunks/YEDV7OB7.js";import{i as ie}from"../chunks/CsOpSJIT.js";import{e as Ve,i as Xe}from"../chunks/DgmZXuMA.js";import{s as He}from"../chunks/YzEcovnq.js";import{s as J}from"../chunks/CFqlu25O.js";import{s as Je}from"../chunks/DjxTXd-0.js";import{b as Qe}from"../chunks/E4uvHImo.js";import{i as Ue}from"../chunks/DowsAlf2.js";import{s as We,a as Ye}from"../chunks/BvfUDuFd.js";import{p as Ze}from"../chunks/_Xj3PGtq.js";import{b as et}from"../chunks/DhRl_mF0.js";import{C as tt}from"../chunks/CMb3mhhO.js";var at=S('<span class="rep-pill svelte-1abhl3i"> </span>'),st=S('<div role="button" tabindex="0"><div class="card-head svelte-1abhl3i"><span class="card-index svelte-1abhl3i"></span> <div class="card-lines svelte-1abhl3i"><p> </p> <p> </p></div></div> <!></div>'),ot=S('<p class="loading svelte-1abhl3i">로딩...</p>'),nt=S('<div class="list svelte-1abhl3i"><!></div> <!> <audio playsinline="" preload="auto" style="display:none"></audio>',1);function xt(ce,pe){Me(pe,!1);const Q=()=>Ye(Ze,"$page",de),[de,ue]=We(),L=s(),O=s(),U=s(),j=s(),q=s(),D=s(),F=s(),W=s();let y=s([]),I=s([]),l=s(-1),n=s(),r=s(!1),o=s("all"),m=null,c=s(!1),p=null,M="all";const P=[0,1e3,3e3,5e3];let x=s(0),u=s("both"),f=s("eng"),R=s(!0),fe=100,z=[1,3,5,10],A=s(0),$=s(z[0]),d=s(0),Y=s(0),w=[];Fe(async()=>{if(!e(L))return;const a=await fetch(`${e(O)}/sentences.json`);if(a.ok){const b=await a.json();t(y,b.sentences),t(I,b.korean)}}),Ie(()=>{e(n)?.pause(),m&&clearTimeout(m),p&&clearTimeout(p)});async function v(a){a<0||a>=e(y).length||(a!==e(l)&&t(d,0),t(l,a),await ze(),document.getElementById(`s-${a}`)?.scrollIntoView({behavior:"smooth",block:"center"}),w=e(f)==="both"?["audio","audiok"]:e(f)==="kor"?["audiok"]:["audio"],await Z())}async function Z(){if(!w.length){t(r,!1);return}const a=w.shift();e(n).pause(),ne(n,e(n).src=`${e(O)}/${a}/${String(e(l)+1).padStart(2,"0")}.mp3`);try{await e(n).play(),t(r,!0)}catch{t(r,!1)}}function me(){m=setTimeout(async()=>{if(w.length)return await Z();if(Ge(d),e(o)==="all"){if(e(d)<e($))return await v(e(l));t(d,0);const a=(e(l)+1)%e(y).length;if(!a&&Ne(Y)>=fe){t(r,!1),t(o,"none");return}return await v(a)}if(e(o)==="one"){if(e(d)<e($))return await v(e(l));t(r,!1);return}if(e(d)<e($))return await v(e(l));t(r,!1)},P[e(x)])}const ve=()=>e(r)?(e(n).pause(),t(r,!1),w=[],m&&clearTimeout(m)):v(e(l)===-1?0:e(l)),be=()=>{e(c)||(t(o,e(o)==="none"?"one":e(o)==="one"?"all":"none"),t(d,0))},he=()=>{t(A,(e(A)+1)%z.length),t(d,0)},_e=()=>{t(f,e(f)==="eng"?"kor":e(f)==="kor"?"both":"eng")},ge=()=>t(u,e(u)==="both"?"hideKor":e(u)==="hideKor"?"hideEng":"both"),ke=()=>t(x,(e(x)+1)%P.length),ye=()=>{e(n)?.pause(),t(r,!1),w=[],m&&clearTimeout(m)},xe=()=>{e(c)?(t(c,!1),p&&clearTimeout(p),p=null,t(o,M)):(M=e(o),t(o,"all"),t(c,!0),p&&clearTimeout(p),p=setTimeout(()=>{ye(),t(c,!1),p=null,t(o,M)},18e5))};function $e(a){switch(a.detail.id){case"play":ve();break;case"repeat":be();break;case"count":he();break;case"disp":ge();break;case"audio":_e();break;case"gap":ke();break;case"sleep":xe();break}}i(()=>Q(),()=>{t(L,Q().url.pathname.match(/\/sentence\/([^\/]+)/)?.[1]||"")}),i(()=>e(L),()=>{t(O,`${et}/assets/sentence/${e(L)}`)}),i(()=>e(A),()=>{t($,z[e(A)])}),i(()=>e(R),()=>{t(U,e(R)?"calc(60px + env(safe-area-inset-bottom))":"env(safe-area-inset-bottom)")}),i(()=>e(o),()=>{e(o)!=="all"&&t(Y,0)}),i(()=>e(n),()=>{e(n)&&ne(n,e(n).onended=me)}),i(()=>e(x),()=>{t(j,e(x)?P[e(x)]/1e3+"s":"즉시")}),i(()=>e(u),()=>{t(q,e(u)==="both"?"한/영":e(u)==="hideKor"?"영":"한")}),i(()=>e(f),()=>{t(D,e(f)==="eng"?"영":e(f)==="kor"?"한":"모두")}),i(()=>e(c),()=>{t(F,e(c)?"슬립ON":"슬립OFF")}),i(()=>(e(r),e(o),e($),e(q),e(D),e(j),e(F),e(c)),()=>{t(W,[{id:"play",icon:e(r)?"⏸":"▶"},{id:"repeat",text:"반복:"+(e(o)==="none"?"없음":e(o)==="one"?"문장":"전체")},{id:"count",text:"횟수:"+e($)+"x",active:!0},{id:"disp",text:e(q)},{id:"audio",text:"음성:"+e(D)},{id:"gap",text:"간격:"+e(j)},{id:"sleep",text:e(F),active:e(c)}])}),Pe(),Ue();var ee=nt(),B=oe(ee),we=g(B);{var Te=a=>{var b=De(),Le=oe(b);Ve(Le,1,()=>e(y),Xe,(Ae,Be,h)=>{var _=st();He(_,"id",`s-${h}`);var G=g(_),ae=g(G);ae.textContent=`${h+1}.`;var se=C(ae,2),K=g(se),Ke=g(K,!0);k(K);var N=C(K,2),Se=g(N,!0);k(N),k(se),k(G);var Oe=C(G,2);{var je=T=>{var V=at(),qe=g(V,!0);k(V),X(()=>H(qe,e(d)+1)),E(T,V)};ie(Oe,T=>{e(r)&&h===e(l)&&T(je)})}k(_),X(()=>{J(_,1,`sentence-card ${e(r)&&h===e(l)?"active":""}`,"svelte-1abhl3i"),J(K,1,`line en ${e(u)==="hideEng"?"hidden":""}`,"svelte-1abhl3i"),H(Ke,e(Be)),J(N,1,`line ko ${e(u)==="hideKor"?"hidden":""}`,"svelte-1abhl3i"),H(Se,(e(I),re(()=>e(I)[h])))}),le("click",_,()=>v(h)),le("keydown",_,T=>["Enter"," "].includes(T.key)&&v(h)),E(Ae,_)}),E(a,b)},Ee=a=>{var b=ot();E(a,b)};ie(we,a=>{e(y),re(()=>e(y).length)?a(Te):a(Ee,!1)})}k(B);var te=C(B,2);tt(te,{get buttons(){return e(W)},$$events:{click:$e,toggle:a=>t(R,a.detail.visible)}});var Ce=C(te,2);Qe(Ce,a=>t(n,a),()=>e(n)),X(()=>Je(B,`--list-bottom:${e(U)}`)),E(ce,ee),Re(),ue()}export{xt as component};
