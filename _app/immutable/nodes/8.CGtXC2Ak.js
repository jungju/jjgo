import{b as p,f as _,d as ue}from"../chunks/DvwRGfww.js";import"../chunks/ZwUaS2xh.js";import{o as tt,a as at}from"../chunks/ClGfkG1t.js";import{an as st,ao as o,ap as nt,aw as J,aq as rt,a as e,E as s,ar as w,s as a,ax as ot,az as lt,ay as Ee,as as d,au as u,aA as it,t as N,u as P}from"../chunks/BuYk74-E.js";import{s as A,e as Q}from"../chunks/YEDV7OB7.js";import{i as G}from"../chunks/CsOpSJIT.js";import{e as ct,i as pt}from"../chunks/DgmZXuMA.js";import{s as vt}from"../chunks/CFqlu25O.js";import{b as ft}from"../chunks/E4uvHImo.js";import{i as dt}from"../chunks/DowsAlf2.js";import{s as ut,a as gt}from"../chunks/BvfUDuFd.js";import{p as _t}from"../chunks/B5xI8iah.js";import{b as ht}from"../chunks/CQovgq6_.js";import{C as mt}from"../chunks/CMb3mhhO.js";var kt=_('<div class="remain-big svelte-h76kl9"> </div>'),bt=_('<p class="placeholder svelte-h76kl9">•••</p>'),xt=_('<p class="kor svelte-h76kl9"> </p>'),yt=_('<p class="eng svelte-h76kl9"> </p>'),wt=_('<p class="eng svelte-h76kl9"> </p>'),$t=_('<div role="button" tabindex="0"><div class="order-big svelte-h76kl9"> </div> <!> <!></div> <button class="next-btn svelte-h76kl9">NEXT ⏭</button>',1),St=_('<div class="result-item svelte-h76kl9" role="button" tabindex="0"><span class="num svelte-h76kl9"></span> <span class="eng txt svelte-h76kl9"> </span> <span class="kor txt svelte-h76kl9"> </span></div>'),Et=_('<div class="result-list svelte-h76kl9"><h2 class="svelte-h76kl9">재생 순서 (클릭·Enter로 다시 듣기)</h2> <!></div>'),It=_('<main class="wrapper svelte-h76kl9"><!></main> <!> <audio playsinline="" preload="auto" class="svelte-h76kl9"></audio>',1);function Tt(Ie,Le){st(Le,!1);const ge=()=>gt(_t,"$page",Ae),[Ae,De]=ut(),ne=s(),D=s(),_e=s(),he=s(),h=s(),g=s(),me=s(),re=s(),V=s(),oe=s(),le=s(),ie=s(),ce=s(),ke=s(),be=[1e4,2e4,3e4,-1],xe=[10,20,50,-1];let Y=s(0),Z=s(0),v=s([]),T=s([]),l=s(-1),ee=s(0),i=s(),m=s(!1),k=s(!1),z=!1,C=s(0),j,U=s(!1),$=s(!0),W=s(!1),f=s(0);const b=new Set;let S=s([]);tt(()=>(fetch(`${e(D)}/sentences.json`).then(t=>t.ok&&t.json()).then(t=>{t&&(a(v,t.sentences),a(T,t.korean))}),window.addEventListener("keydown",ye),()=>window.removeEventListener("keydown",ye))),at(()=>{e(i)?.pause(),clearInterval(j)});function ye(t){if(!e(U)){if(["Space","ArrowRight"].includes(t.code))t.preventDefault(),E();else if(t.code==="ArrowLeft"&&e(S).length>1){t.preventDefault();const n=e(S).pop();n!==void 0&&b.delete(n),a(ee,e(S).length),q(e(S).at(-1),!1)}}}function ze(){if(e(g)>=0&&b.size>=e(g)||b.size===e(v).length)return-1;let t;do t=Math.floor(Math.random()*e(v).length);while(b.has(t));return t}async function q(t,n=!0){if(!(t<0||t>=e(v).length)){n&&ot(ee),a(l,t),b.add(t),n&&e(S).push(t),await lt(),e(i).pause(),Ee(i,e(i).src=`${e(me)==="kor"?e(he):e(_e)}/${String(t+1).padStart(2,"0")}.mp3`);try{await e(i).play(),a(m,!0)}catch{z=!0}}}function Ce(){e(i)&&Ee(i,e(i).onended=()=>{if(a(m,!1),z){z=!1,E();return}e(g)>=0&&b.size>=e(g)||e(g)<0&&b.size===e(v).length||e(h)>=0&&je()})}function je(){e(h)<0||(e(k)&&clearInterval(j),a(k,!0),a(C,Math.ceil(e(h)/1e3)),j=setInterval(()=>{it(C,-1)<=0&&(clearInterval(j),a(k,!1),e(m)?z=!0:E())},1e3))}function E(){e(i).pause(),clearInterval(j),a(m,a(k,z=!1)),a(C,0);const t=ze();if(t===-1){a(U,!0);return}q(t,!0)}const Me=(t,n)=>n===1?"_".repeat(t.length):n===2?t[0]+"_".repeat(t.length-1):t,Oe=t=>e(f)===4?t:e(f)===3?t.split(" ").map((n,c)=>c%2?"_".repeat(n.length):n).join(" "):e(f)>0?t.split(" ").map(n=>Me(n,e(f))).join(" "):"";function M(){e(i).pause(),clearInterval(j),a(m,a(k,z=!1)),a(l,-1),a(ee,a(C,0)),b.clear(),a(S,[]),a(U,!1)}function Re(){e(m)||e(k)||e(U)?M():E()}function Be(){M(),a(Z,(e(Z)+1)%xe.length)}function He(t=!1){M(),a(f,(e(f)+(t?-1:1)+5)%5)}function Ke(){M(),a($,!e($))}function Ne(){a(W,!e(W))}function Ge(){M(),a(Y,(e(Y)+1)%be.length)}const we=t=>q(t,!1);function Te(t){const{id:n,backward:c=!1}=t.detail;switch(n){case"start":Re();break;case"count":Be();break;case"hint":He(c);break;case"lang":Ke();break;case"hide":Ne();break;case"gap":Ge();break}}o(()=>ge(),()=>{a(ne,ge().params.id)}),o(()=>e(ne),()=>{a(D,`${ht}/assets/sentence/${e(ne)}`)}),o(()=>e(D),()=>{a(_e,`${e(D)}/audio`)}),o(()=>e(D),()=>{a(he,`${e(D)}/audiok`)}),o(()=>e(Y),()=>{a(h,be[e(Y)])}),o(()=>e(Z),()=>{a(g,xe[e(Z)])}),o(()=>e($),()=>{a(me,e($)?"kor":"eng")}),o(()=>e(i),()=>{e(i)&&Ce()}),o(()=>e(g),()=>{a(re,e(g)<0?"전체":`${e(g)}개`)}),o(()=>(e(m),e(k)),()=>{a(V,e(m)||e(k))}),o(()=>e(h),()=>{a(oe,e(h)<0?"∞":`${e(h)/1e3}s`)}),o(()=>e(f),()=>{a(le,`H${e(f)}`)}),o(()=>e($),()=>{a(ie,e($)?"한":"영")}),o(()=>e(W),()=>{a(ce,e(W)?"보기":"가리기")}),o(()=>(e(V),e(re),e(le),e(f),e(ie),e(ce),e(oe)),()=>{a(ke,[{id:"start",icon:e(V)?"⏹":"▶"},{id:"count",text:`출제:${e(re)}`},{id:"hint",text:e(le),active:e(f)>0},{id:"lang",text:e(ie)},{id:"hide",text:e(ce)},{id:"gap",text:e(oe)}])}),nt(),dt();var $e=It(),pe=J($e),Ue=d(pe);{var We=t=>{var n=$t(),c=J(n),X=d(c),x=d(X,!0);u(X);var te=w(X,2);{var I=r=>{var y=kt(),O=d(y,!0);u(y),N(()=>A(O,e(C))),p(r,y)};G(te,r=>{e(h)>=0&&e(C)>0&&r(I)})}var ae=w(te,2);{var F=r=>{var y=ue(),O=J(y);{var Fe=R=>{var se=bt();p(R,se)},Je=R=>{var se=ue(),Pe=J(se);{var Qe=B=>{var H=xt(),fe=d(H,!0);u(H),N(()=>A(fe,(e(T),e(l),P(()=>e(T)[e(l)])))),p(B,H)},Ve=B=>{var H=ue(),fe=J(H);{var Ye=K=>{var L=yt(),de=d(L,!0);u(L),N(et=>A(de,et),[()=>(e(v),e(l),P(()=>Oe(e(v)[e(l)])))]),p(K,L)},Ze=K=>{var L=wt(),de=d(L,!0);u(L),N(()=>A(de,(e(v),e(l),P(()=>e(v)[e(l)])))),p(K,L)};G(fe,K=>{e(f)>0?K(Ye):K(Ze,!1)},!0)}p(B,H)};G(Pe,B=>{e($)?B(Qe):B(Ve,!1)},!0)}p(R,se)};G(O,R=>{e(W)?R(Fe):R(Je,!1)})}p(r,y)};G(ae,r=>{e(l)!==-1&&r(F)})}u(c);var ve=w(c,2);N(()=>{vt(c,1,`sentence-box ${e(V)?"playing":""}`,"svelte-h76kl9"),A(x,e(l)===-1?"Ready":`#${e(ee)}`)}),Q("click",c,function(...r){(e(l)===-1?E:()=>q(e(l),!1))?.apply(this,r)}),Q("keydown",c,r=>["Enter"," "].includes(r.key)&&(r.preventDefault(),e(l)===-1?E():q(e(l),!1))),Q("click",ve,E),p(t,n)},qe=t=>{var n=Et(),c=w(d(n),2);ct(c,1,()=>e(S),pt,(X,x,te)=>{var I=St(),ae=d(I);ae.textContent=`${te+1}.`;var F=w(ae,2),ve=d(F,!0);u(F);var r=w(F,2),y=d(r,!0);u(r),u(I),N(()=>{A(ve,(e(v),e(x),P(()=>e(v)[e(x)]))),A(y,(e(T),e(x),P(()=>e(T)[e(x)])))}),Q("click",I,()=>we(e(x))),Q("keydown",I,O=>["Enter"," "].includes(O.key)&&(O.preventDefault(),we(e(x)))),p(X,I)}),u(n),p(t,n)};G(Ue,t=>{e(U)?t(qe,!1):t(We)})}u(pe);var Se=w(pe,2);mt(Se,{get buttons(){return e(ke)},$$events:{click:Te}});var Xe=w(Se,2);ft(Xe,t=>a(i,t),()=>e(i)),p(Ie,$e),rt(),De()}export{Tt as component};
